(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{858:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(3),c=a(2),i=a(13),o=a.n(i),s=a(4),l=a(14),b=a(7),m=a(759),p=a(776),u=a(22),d=a(127),f=a(244),O=a(79),y=a(12);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){w(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function h(e,t,a,n,r,c,i){try{var o=e[c](i),s=o.value}catch(e){return void a(e)}o.done?t(s):Promise.resolve(s).then(n,r)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done)&&(a.push(i.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return E(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}t.default=function(e){var t=location&&location.search?Object(u.parse)(location.search.substring(1)):{},a=Object(p.a)(),i=v(Object(n.useState)(!0),2),j=i[0],w=i[1],E=v(Object(n.useState)({}),2),_=E[0],k=E[1],P=v(Object(n.useState)(!0),2),N=P[0],S=P[1],x=v(Object(n.useState)({message:"",type:1}),2),C=x[0],T=x[1],I=v(Object(n.useState)(!1),2),A=I[0],B=I[1],D=v(Object(n.useState)(!1),2),F=D[0],J=(D[1],a.setCampaignValues),M=a.setExclude,R=(Object(b.f)(),function(){var e=!0;!Object(r.isEmpty)(_.title)&&[1,2,3].includes(parseInt(_.type))&&(e=!1),!e&&2==_.type&&F&&(e=!0),e||3!=_.type||Object(b.db)()||(e=!0),S(e)}),q=m.a.getCampaignId(),H=m.a.getCampaignData(),U=m.a.getExcludes(),V=!!(!(!H||!H.parent)&&H.parent);Object(n.useEffect)((function(){H&&q>0&&e.campaignId==q&&(k({title:H.title,description:H.description,type:H.type,isPromotional:!H.data||!H.data.hasOwnProperty("is_promotional")||H.data.is_promotional,abType:H.data&&H.data.hasOwnProperty("ab_type")?H.data.ab_type:"standard"}),w(!1)),0==e.campaignId&&(k({title:"",description:"",type:0,isPromotional:!1,abType:!1}),w(!1))}),[q]),Object(n.useEffect)((function(){R()}),[_,F]);var W=function(){var a,n=(a=regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(N){a.next=18;break}if(e.setPending(!0),c=void 0,c={title:H.title,description:H.description,type:H.type,isPromotional:H.data&&H.data.hasOwnProperty("is_promotional")?H.data.is_promotional:null,abType:H.data&&H.data.hasOwnProperty("ab_type")?H.data.ab_type:null},JSON.stringify(c)==JSON.stringify(_)){a.next=14;break}if(!(q>0)){a.next=12;break}return a.prev=4,a.next=7,o()({path:Object(b.g)("/broadcast/".concat(q)),method:"POST",data:{data:{title:_.title,description:_.description,type:_.type,promotional:_.isPromotional,ab_type:_.abType,modified_by:Object(b.o)(),exclude:U},step:1},headers:{"Content-Type":"application/json"}}).then((function(e){if(200==e.code){J("data",g(g({},H),{},{title:e.result.title,description:e.result.description,type:e.result.type,data:e.result.data})),T({message:e.message,type:1});var a=H.data&&!Object(r.isNull)(H.data)&&H.data.hasOwnProperty("filters")?H.data.filters:{};Object(r.isEmpty)(a)||Object(l.j)(a,"/",t),J("step",2)}else T({message:e.message,type:0})}));case 7:a.next=12;break;case 9:a.prev=9,a.t0=a.catch(4),T({message:a.t0.message,type:0});case 12:a.next=17;break;case 14:n=H.data&&H.data.hasOwnProperty("filters")?H.data.filters:{},Object(r.isEmpty)(n)||Object(l.j)(n,"/",t),J("step",2);case 17:e.setPending(!1);case 18:case"end":return a.stop()}var c}),a,null,[[4,9]])})),function(){var e=this,t=arguments;return new Promise((function(n,r){var c=a.apply(e,t);function i(e){h(c,n,r,i,o,"next",e)}function o(e){h(c,n,r,i,o,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}();return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(O.a,null),j||Object(r.isEmpty)(_)?Object(n.createElement)("div",{className:"bwf-crm-campaign-preview bwf-placeholder-content"},[0,1,2,3,4].map((function(e){return Object(n.createElement)("div",{className:"bwf-crm-campaign-field",key:e},Object(n.createElement)("div",{className:"is-placeholder long",style:{width:"20%"}}),Object(n.createElement)("div",{className:"is-placeholder long",style:{width:"100%"}}))}))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)(s.Card,{className:"bwf-campaign-step-div bwf-card-wrap bwf-campaign-step-1"},Object(n.createElement)("div",{className:"bwf-card-header"},Object(n.createElement)("span",{className:"bwf-form-title"},Object(c.__)("Information","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-card-bg-wrap"},Object(n.createElement)(s.TextControl,{value:_.title,label:Object(c.__)("Name","wp-marketing-automations"),className:"bwf-campaign-input-field",placeholder:Object(c.__)("Enter Name","wp-marketing-automations"),onChange:function(e){k(g(g({},_),{},{title:e}))}}),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",null,Object(n.createElement)(s.Flex,{gap:5,justify:"start",align:"start"},Object(n.createElement)(s.FlexItem,null,Object(n.createElement)("p",{className:"bwf-c-input-label"},Object(c.__)("Type","wp-marketing-automations")),Object(n.createElement)(f.a,{isSelected:"standard"===_.abType,onClick:function(){k(g(g({},_),{},{abType:"standard"}))},alterButton:!0},Object(c.__)("Standard","wp-marketing-automations")),Object(n.createElement)(f.a,{isSelected:"ab"===_.abType,onClick:function(){k(g(g({},_),{},{abType:"ab"}))},alterButton:!0},Object(c.__)("A/B Test","wp-marketing-automations"))))),Object(n.createElement)("div",{className:"bwf_clear_20"}),!V&&Object(n.createElement)(s.CheckboxControl,{className:"bwf-crm-campaign-toggle",label:Object(c.__)("Send it to all contacts including unsubscribers","wp-marketing-automations"),help:[Object(c.__)("This allows you to send the email to all your contacts, even if their status is unsubscribed or unverified.","wp-marketing-automations"),Object(n.createElement)("br",null),Object(c.__)("On the default mode, your broadcast will be sent only to the subscribed contacts","wp-marketing-automations")],checked:!_.isPromotional,onChange:function(e){M([]),k(g(g({},_),{},{isPromotional:!e}))}}),A&&Object(n.createElement)(s.Modal,{title:Object(c.__)("Configure SMS Setting","wp-marketing-automations"),onRequestClose:function(){return B(!1)},style:{minWidth:"500px",height:"fit-content"},className:"bwf-crm-merge-tag-model"},Object(n.createElement)("p",null,Object(n.createElement)(y.a,{icon:"profile"})),Object(n.createElement)("a",{href:"admin.php?page=autonami&tab=connector",className:"bwf-a-no-underline"},Object(c.__)("Click Here to go configuration page","wp-marketing-automations")),Object(n.createElement)("p",null,Object(n.createElement)(s.Button,{isPrimary:!0,onClick:function(){return B(!1)}},Object(c.__)("Cancel","wp-marketing-automations")))),Object(n.createElement)(d.a,{message:C.message,type:C.type,removeMessage:function(){return T({message:"",type:1})}})),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-crm-stepper-navigation bwf_text_right"},Object(n.createElement)(s.Button,{isPrimary:!0,className:"bwf-crm-navigation-next bwf-big-button",disabled:N,onClick:function(){R(),W()}},Object(n.createElement)("span",null,Object(c.__)("Next","wp-marketing-automations")))))))}}}]);