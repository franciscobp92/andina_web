(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{763:function(e,t,r){"use strict";var n=r(0),a=r(35),c=r(2),o=r(758);t.a=function(e){var t=e.selected,r=e.onTagsChange;return Object(n.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(n.createElement)("div",{className:"bwf-input-label"},Object(c.__)("Add Tags","wp-marketing-automations")),Object(n.createElement)(a.a,{autocompleter:o.b,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){r(e)},onRemoveTag:function(e,n){var a=t.filter((function(t){return!(t.key==e&&t.label==n)}));r(a)},placeholder:Object(c.__)("Search by tag name","wp-marketing-automations"),showClearButton:!0,disabled:!1}))}},765:function(e,t,r){"use strict";var n=r(0),a=r(35),c=r(2),o=r(758);t.a=function(e){var t=e.selected,r=e.onListsChange;return Object(n.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(n.createElement)("div",{className:"bwf-input-label"},Object(c.__)("Add to Lists","wp-marketing-automations")),Object(n.createElement)(a.a,{autocompleter:o.a,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){r(e)},onRemoveTag:function(e){var n=t.filter((function(t){return t.key!=e}));r(n)},placeholder:Object(c.__)("Search by list name","wp-marketing-automations"),showClearButton:!0,disabled:!1}))}},771:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0);var a=function(e,t){var r=Object(n.useRef)();Object(n.useEffect)((function(){r.current=e}),[e]),Object(n.useEffect)((function(){if(null!==t){var e=setInterval((function(){r.current()}),t);return function(){return clearInterval(e)}}}),[t])}},852:function(e,t,r){},925:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(7),c=r(2),o=(r(852),r(781)),i=r(79),s=r(757),l=r(13),u=r.n(l);function m(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function b(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){m(c,n,a,o,i,"next",e)}function i(e){m(c,n,a,o,i,"throw",e)}o(void 0)}))}}var f=function(){return Object(s.a)(["get-affwp-affiliate-count"],b(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u()({path:Object(a.g)("/import/affwp/get-affiliate-count")});case 2:if((t=e.sent).code&&200===t.code){e.next=5;break}throw new Error(Object(c.__)("Unable to load affiliate count","wp-marketing-automations"));case 5:return e.abrupt("return",parseInt(t.result));case 6:case"end":return e.stop()}}),e)}))))},p=r(34),O=r(4),d=r(763),j=r(765);function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var v={0:Object(c.__)("Unverified","wp-marketing-automation-crm"),1:Object(c.__)("Subscribed","wp-marketing-automation-crm"),2:Object(c.__)("Bounced","wp-marketing-automation-crm"),3:Object(c.__)("Unsubscribed","wp-marketing-automation-crm")},h=function(e){var t=e.onStartImport,r=e.setStep,o=e.setImporter,s=f(),l=s.isLoading,u=s.data,m=void 0===u?0:u,b=s.isError,g=s.error,h=w(Object(n.useState)(!1),2),y=h[0],_=h[1],E=w(Object(n.useState)(!1),2),k=E[0],S=E[1],I=w(Object(n.useState)([]),2),N=I[0],C=I[1],A=w(Object(n.useState)([]),2),x=A[0],P=A[1],T=w(Object(n.useState)(1),2),F=T[0],B=T[1],U=Object(n.useContext)(a.b),R=Object(n.useCallback)((function(){return t({tags:N.map((function(e){return{id:e.key,value:e.label}})),lists:x.map((function(e){return{id:e.key,value:e.label}})),update_existing:y,disable_events:k,imported_contact_status:F})}),[N,x,y,k,F,t]);return Object(n.useEffect)((function(){b&&(U("string"==typeof g?g:g&&g.message?g.message:Object(c.__)("Unknown API Error","wp-marketing-automations")),Object(a.Q)(U,2e3))}),[b,g]),l?Object(n.createElement)(n.Fragment,null,Object(n.createElement)(i.a,null),Object(n.createElement)(p.a,null)):Object(n.createElement)(n.Fragment,null,Object(n.createElement)(O.Card,{className:"bwf-crm-importer-wp-roles-wrap"},Object(n.createElement)("div",{className:"bwf-card-wrap"},Object(n.createElement)("div",{className:"bwf-card-header bwf-h4"},Object(c.__)("Configuration","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-crm-import-section bwf-t-center"},Object(n.createElement)("div",{className:"bwf-h3"},Object(c.__)("AffiliateWP Affiliates","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-p bwf-p2"},m+" "+Object(c.__)("affiliates are available for import.","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-crm-import-section"},Object(n.createElement)("div",{className:"bwf-h3"},Object(c.__)("Contact Profile","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-c-import-field"},Object(n.createElement)(d.a,{onTagsChange:C,selected:N}),Object(n.createElement)(j.a,{onListsChange:P,selected:x})),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-p"},Object(c.__)("Status","wp-marketing-automations")),Object(n.createElement)("select",{className:"bwf-import-wp-status-select",onChange:function(e){B(e.target.value)}},Object.keys(v).map((function(e){return Object(n.createElement)("option",{key:e,value:e,selected:F==e},v[e])}))),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)(O.ToggleControl,{checked:y,label:Object(c.__)("Update existing contact status","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",onChange:function(e){return _(e)}}),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)(O.ToggleControl,{label:Object(c.__)("Trigger automations (for tag & list related events)","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",checked:k,onChange:S})),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-form-buttons"},Object(n.createElement)("div",{className:"bwf-crm-btn-right-alignment"},Object(n.createElement)(O.Button,{disabled:0===parseInt(m),isPrimary:!0,onClick:R},Object(c.__)("Import","wp-marketing-automations"))))),Object(n.createElement)("div",{className:"bwf-crm-importer-navigation"},Object(n.createElement)(O.Button,{className:"bwf-crm-navigation-back bwf-display-flex",isSecondary:!0,onClick:function(){r(1),o(null)}},Object(n.createElement)("span",null,Object(c.__)("Back","wp-marketing-automations")))))},y=r(232),_=r(771),E=r(784),k=r(14),S=r(22),I=r(3);function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var F=function(e){var t=e.requestData,r=e.existingImport,o=e.setStep,i=P(Object(n.useState)(!1),2),s=i[0],l=i[1],m=P(Object(n.useState)(null),2),b=m[0],f=m[1],p=P(Object(n.useState)(t&&"importId"in t?parseInt(t.importId):0),2),d=p[0],j=p[1],w=b&&"log"in b?b.log:{},g=w.skipped,v=void 0===g?0:g,h=w.failed,N=void 0===h?0:h,A=w.succeed,T=void 0===A?0:A,F=P(Object(n.useState)(null),2),B=F[0],U=F[1],R=Object(E.a)().showBackButton,D=location&&location.search?Object(S.parse)(location.search.substring(1)):{},L=0,W=P(Object(n.useState)(5e3),2),M=W[0],$=W[1],q=P(Object(n.useState)(!0),2),z=q[0],J=q[1],G=function(){var e,n=(e=regeneratorRuntime.mark((function e(){var n,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L++,e.prev=1,n=parseInt(d)>0?{import_id:d}:t,z&&!r?(J(!1),n.start_import=!0):n.start_import=!1,e.next=6,u()({method:"POST",data:n,path:Object(a.g)("/import/affwp/status")});case 6:c=e.sent,f(c.result),j(parseInt(c.result.import_id)),c.result&&"status"in c.result&&"success"===c.result.status&&($(null),R(!1),l(!0)),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),$(null),R(!1),U(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){x(c,n,a,o,i,"next",e)}function i(e){x(c,n,a,o,i,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();return Object(_.a)((function(){Object(I.isEmpty)(d)&&0!=L||G()}),M),Object(n.useEffect)((function(){return R(!0),window.scrollTo(0,0),function(){R(!1)}}),[]),B||b&&!1 in b?Object(n.createElement)(O.Notice,{status:"error"},B&&"message"in B?B.message:Object(c.__)("There are some technical difficulties while processing CSV Import","wp-marketing-automations")):b?b&&"percent"in b?Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-crm-import-progress-wrap"},Object(n.createElement)("div",{className:"bwf-t-center"},Object(n.createElement)("h2",null,Object(c.__)("Import Progress","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf-p bwf-p2"},Object(c.__)("Import has begun in the background. We will let you know when it completes.","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf_clear_30"}),Object(n.createElement)(y.a,{status:b.status,size:"lg",progress:parseInt(b.percent),text:Object(c.__)("".concat(b.percent,"%"),"wp-marketing-automations")}),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("p",null,"Skipped: ",parseInt(v)>0?v:0,", Failed:"," ",parseInt(N)>0?N:0,", Success:"," ",parseInt(T)>0?T:0)),s&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-crm-importer-back-button"},Object(n.createElement)(O.Button,{className:"bwf-crm-navigation-back",isPrimary:!0,onClick:function(){Object(k.j)(C(C({},D),{},{path:"/contacts"}),"/contacts",D),o(1)}},Object(c.__)("Go To Contacts","wp-marketing-automations"))))):null:Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-crm-import-progress-wrap"},Object(n.createElement)("div",{className:"bwf-t-center"},Object(n.createElement)("h2",null,Object(c.__)("Import Progress","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf-p bwf-p2"},Object(c.__)("Import has begun in the background. We will let you know when it completes.","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf_clear_30"}),Object(n.createElement)(y.a,{status:"info",size:"lg",progress:0,text:Object(c.__)("0%","wp-marketing-automations")}),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-p"},"Skipped: ",parseInt(v)>0?v:0,", Failed: ",parseInt(N)>0?N:0,", Success: ",parseInt(T)>0?T:0)))};function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}t.default=function(e){var t=e.step,r=e.setStep,s=e.setImporter;Object(a.d)("AFFWP Importer");var l=B(Object(n.useState)(null),2),u=l[0],m=l[1],b=(0,Object(o.a)().getExistingImports)().affwp;return Object(n.useEffect)((function(){parseInt(b)>0&&(m({importId:b}),r(3))}),[]),Object(n.createElement)("div",{className:"bwf-crm-importer-wrap"},2==t&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)(h,{setStep:r,setImporter:s,onStartImport:function(e){m(e),r(3)}})),3==t&&u&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)(i.a,null),Object(n.createElement)("div",{className:"bwf-card-wrap"},Object(n.createElement)("div",{className:"bwf-card-header bwf-h4"},Object(c.__)("Confirmation","wp-marketing-automations"))),Object(n.createElement)(F,{setStep:r,requestData:u,setImporter:s,existingImport:parseInt(b)>0})))}}}]);