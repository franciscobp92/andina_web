(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{806:function(e,t,r){"use strict";var n=r(219),a=r(0);t.a=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=bwfcrm_contacts_data&&bwfcrm_contacts_data.header_data?bwfcrm_contacts_data.header_data:{},c=Object(n.a)(),o=c.setActiveMultiple,i=c.setL2NavType,s=c.setL2Nav,u=c.resetHeaderMenu,l=c.setPageHeader,p=c.setPageCountData,b=c.setL2Content;return Object(a.useEffect)((function(){u(),o({leftNav:"templates",rightNav:"templates"}),i("menu"),s(r.templates_nav),l("Templates"),p({templates:t}),e&&b(e)}),[t]),!0}},837:function(e,t,r){},920:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(7),c=r(219),o=r(14),i=r(13),s=r.n(i),u=r(222);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},c=Object.keys(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var f=function(){var e=Object(u.a)("singleTemplateData"),t=e.fetch,r=e.setStateProp;return p(p({},m(e,["fetch","setStateProp"])),{},{fetch:function(e){t("GET",Object(a.g)("/template/".concat(e)))},setTemplateData:function(e){r("data",e)}})},d=r(3);function O(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function y(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){O(c,n,a,o,i,"next",e)}function i(e){O(c,n,a,o,i,"throw",e)}o(void 0)}))}}var h=function(e,t){var r,n,c,o,i=f().setTemplateData;return{sendTestEmail:(o=y(regeneratorRuntime.mark((function e(t,r,n,c,o,i){var u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u={email:t,content:JSON.stringify({subject:r,body:n,type:c,mail_data:o,preheader:i})},e.next=4,s()({method:"POST",path:Object(a.g)("/send-test-email"),data:u});case 4:return e.abrupt("return",2);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",3);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(e,t,r,n,a,c){return o.apply(this,arguments)}),saveEditorContent:(c=y(regeneratorRuntime.mark((function r(n){var c,o,u;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(""!=n[0].editor.body){r.next=2;break}return r.abrupt("return",2);case 2:return c=t,"editor"===(o=Object(d.isEmpty)(n)?{}:n[0]).type?o.hasOwnProperty("editor")&&(o.editor.hasOwnProperty("body")&&(c.template=o.editor.body),o.editor.hasOwnProperty("design")&&(c.data.design=o.editor.design)):c.template=o.body,u={content:JSON.stringify({template:c.template,data:c.data})},r.prev=6,r.next=9,s()({method:"POST",path:Object(a.g)("/template/".concat(e,"/save-email-content")),data:u}).then((function(e){200==e.code&&i(e.result)}));case 9:return r.abrupt("return",2);case 12:return r.prev=12,r.t0=r.catch(6),r.abrupt("return",3);case 15:case"end":return r.stop()}}),r,null,[[6,12]])}))),function(e){return c.apply(this,arguments)}),uploadImage:(n=y(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("image",t),e.prev=2,e.next=5,s()({method:"POST",path:Object(a.g)("/upload-image"),body:r});case 5:return n=e.sent,e.abrupt("return",n&&n.result?n.result:"");case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return","");case 12:case"end":return e.stop()}}),e,null,[[2,9]])}))),function(e){return n.apply(this,arguments)}),fetchCurrentMailEditorContent:(r=y(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","");case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})}},w=r(250),j=r(4),v=r(221);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},c=Object.keys(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var T={1:"rich",2:"wc",3:"html",4:"editor"},k=function(){var e=Object(v.a)("singleTemplateData"),t=e.getStateProp;return P(P({},S(e,["getStateProp"])),{},{getTemplateData:function(){return t("data")},getFormattedTemplateData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(d.isEmpty)(e))return{};var t={body:"",editor:{body:"",design:""},preheader:"",subject:"",type:"rich",utm:{source:"Newsletter",medium:"email",name:"",content:"",term:""},utmEnabled:!1};return e.hasOwnProperty("template")&&(e.hasOwnProperty("mode")&&4===parseInt(e.mode)?t.editor.body=e.template:t.body=e.template),e.hasOwnProperty("subject")&&(t.subject=e.subject),e.hasOwnProperty("mode")&&(t.type=T[e.mode]),e.hasOwnProperty("subject")&&(t.subject=e.subject),e.hasOwnProperty("data")&&(t.subject=e.subject,e.data.hasOwnProperty("preheader")&&(t.preheader=e.data.preheader),e.data.hasOwnProperty("utmEnabled")&&e.data.utmEnabled&&(t.utmEnabled=e.data.utmEnabled),e.data.hasOwnProperty("utm")&&(t.utm=e.data.utm),e.data.hasOwnProperty("design")&&4===parseInt(e.mode)&&(t.editor.design=e.data.design)),t}})},N=r(2),_=r(121),D=r(79);function x(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw c}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var M=function(e){var t=e.templateId,r=f(),o=r.fetch,i=r.setTemplateData,u=k(),l=u.getLoading,p=u.getTemplateData,b=u.getFormattedTemplateData,m={rich:1,wc:2,html:3,editor:4},O=Object(c.a)().setL2Title,y=L(Object(n.useState)({loading:!1,status:!1}),2),v=y[0],g=y[1],P=L(Object(n.useState)([]),2),E=P[0],S=P[1];Object(n.useEffect)((function(){parseInt(t)>0&&o(t)}),[]);var T=l(),C=p();Object(n.useEffect)((function(){O(C.hasOwnProperty("title")?C.title:"")}),[T,C]);var R=function(){var e,r=(e=regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A()){e.next=11;break}return g({status:!0,loading:!0}),r={content:JSON.stringify(C)},e.prev=3,e.next=6,s()({path:Object(a.g)("/template/".concat(t)),method:"POST",data:r}).then((function(e){200==e.code&&g({status:!0,success:e.message})}));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),g({status:!0,error:e.t0.message});case 11:case"end":return e.stop()}}),e,null,[[3,8]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var c=e.apply(t,r);function o(e){x(c,n,a,o,i,"next",e)}function i(e){x(c,n,a,o,i,"throw",e)}o(void 0)}))});return function(){return r.apply(this,arguments)}}(),A=function(){var e=!1,t=[];return C.hasOwnProperty("title")&&!Object(d.isEmpty)(C.title)||(e=!0,t.push(Object(N.__)("Title is required field.","wp-marketing-automations"))),C.hasOwnProperty("subject")&&!Object(d.isEmpty)(C.subject)||(e=!0,t.push(Object(N.__)("Subject is required field.","wp-marketing-automations"))),C.hasOwnProperty("template")&&!Object(d.isEmpty)(C.template)||(e=!0,t.push(Object(N.__)("Email content cannot be empty.","wp-marketing-automations"))),S(t),e},M=Object(n.createElement)(j.Card,{className:"bwf-template-card bwf-p-15 bwf-template-placeholder"},[1,2,3].map((function(e){return Object(n.createElement)("div",{key:e,className:"bwf-placeholder-temp"})})),Object(n.createElement)("div",{className:"bwf-btn-section"},Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-btn bwf-h-zero"}),Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"})),Object(n.createElement)("div",{key:4,className:"bwf-editor-placeholder"}),Object(n.createElement)("div",{className:"bwf-btn-section"},Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"}),Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-btn"})),Object(n.createElement)("div",{key:5,className:"bwf-placeholder-temp"}));return Object(n.createElement)("div",{className:"bwfcrm-overview-wrap bwf-crm-single-template-section"},T||Object(d.isEmpty)(C)?M:Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-template-card"},Object(n.createElement)("div",{className:"bwf-template-card-header bwf-h4"},Object(N.__)("Template","wp-marketing-automations")),Object(n.createElement)(j.Card,{className:"bwf-name-card bwf-p-25"},!Object(d.isEmpty)(E)&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)(D.a,null),Object(n.createElement)(j.Notice,{status:"error",isDismissible:!1,className:"bwf-mtb-10"},E.map((function(e){return Object(n.createElement)(n.Fragment,null,e,Object(n.createElement)("br",null))})))),Object(n.createElement)(j.TextControl,{label:Object(N.__)("Name","wp-marketing-automations"),placeholder:Object(N.__)("Enter Template Name","wp-marketing-automations"),value:C.hasOwnProperty("title")?C.title:"",autocomplete:"off",onChange:function(e){i(I(I({},C),{},{title:e}))}})),Object(n.createElement)(w.a,{disableDefaultButtons:!0,initData:{content:[b(C)]},validateEmailContent:!1,apiMethods:h?h(t,C):{},showSenderInfo:!1,showSaveTemplate:!1,showTemplateTypeSelector:!0,returnData:!0,setMailData:function(e){var t=C;(e=e[1]).hasOwnProperty("subject")&&(t.subject=e.subject),e.hasOwnProperty("preheader")&&(t.data=I(I({},t.data),{},{preheader:e.preheader})),e.hasOwnProperty("type")&&m.hasOwnProperty(e.type)&&(t.mode=m[e.type]),e.hasOwnProperty("utmEnabled")&&(t.data=I(I({},t.data),{},{utmEnabled:e.utmEnabled})),e.hasOwnProperty("utm")&&(t.data=I(I({},t.data),{},{utm:e.utm})),"editor"===e.type?e.hasOwnProperty("editor")&&(e.editor.hasOwnProperty("body")&&(t.template=e.editor.body),e.editor.hasOwnProperty("design")&&(t.data.design=e.editor.design)):t.template=e.body,i(I(I({},C),t))},showTab:!1})),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-crm-stepper-navigation bwf_text_right"},Object(n.createElement)(j.Button,{isPrimary:!0,className:"bwf-crm-navigation-next bwf-big-button",onClick:function(){R()}},Object(N.__)("Save","wp-marketing-automations")))),Object(n.createElement)(_.a,{confirmText:v.confirmText,confirmButtonText:v.buttonConfirm,cancelButtonText:v.buttonCancel,onConfirm:v.onConfirm,isLoading:v.loading,successMessage:v.success,errorMessage:v.error,onRequestClose:function(){return g({status:!1})},isOpen:v.status}))},B=r(806);r(837),t.default=function(e){var t=e.match.params.id,r=Object(o.h)(),i=Object(c.a)(),s=i.setBackLink,u=i.setBackLinkLabel,l=i.setL2Nav;return Object(B.a)(Object(N.__)("Templates","wp-marketing-automations")),Object(n.useEffect)((function(){Object(a.d)("Template #"+t),l(""),s(Object(o.f)({},"/templates",r)),u("All Templates")})),Object(n.createElement)(M,{templateId:t,query:r})}}}]);