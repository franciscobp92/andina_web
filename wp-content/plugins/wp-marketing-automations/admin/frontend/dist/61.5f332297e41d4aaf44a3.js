(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{805:function(e,t,n){"use strict";var a=n(0),r=n(121),c=n(13),o=n.n(c),i=n(7),s=n(2);function l(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}t.a=function(e){var t=u(Object(a.useState)(!1),2),n=t[0],c=t[1],m=u(Object(a.useState)(""),2),b=m[0],f=m[1],p=u(Object(a.useState)(""),2),d=p[0],O=p[1],j=e.isOpen,g=e.cartId,y=e.onRequestClose,h=function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,o()({path:Object(i.g)("/carts"),method:"POST",headers:{"X-HTTP-Method-Override":"DELETE"},data:{abandoned_ids:[g]}});case 4:e.sent,f(Object(s.__)("Cart deleted successfully","wp-marketing-automations")),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),O(e.t0&&e.t0.message?e.t0.message:Object(s.__)("Unknown error occurred","wp-marketing-automations")),console.log(d);case 12:c(!1);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){l(c,a,r,o,i,"next",e)}function i(e){l(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(a.createElement)(r.a,{confirmText:Object(s.__)("Delete Cart?","wp-marketing-automations"),confirmButtonText:Object(s.__)("Delete","wp-marketing-automations"),cancelButtonText:Object(s.__)("Cancel","wp-marketing-automations"),onConfirm:h,isLoading:n,successMessage:b,errorMessage:d,onRequestClose:function(){y(!!b),f(""),O(""),c(!1)},isOpen:j,isDelete:!0})}},933:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(7),c=n(13),o=n.n(c),i=n(2),s=n(46),l=n(122),u=n(17),m=n(4),b=n(220),f=n(786),p=n(803),d=n(82),O=n(56),j=n(5),g=n.n(j),y=n(223),h=n(804),w=n(805),v=n(121);function _(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var S=function(e){var t=E(Object(a.useState)(!1),2),n=t[0],c=t[1],s=E(Object(a.useState)(""),2),l=s[0],u=s[1],m=E(Object(a.useState)(""),2),b=m[0],f=m[1],p=e.isOpen,d=e.cartId,O=e.onRequestClose;Object(a.useEffect)((function(){p&&j()}),[p]);var j=function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,o()({path:Object(r.g)("/carts/abandoned/retry"),method:"POST",data:{abandoned_ids:[d]}});case 4:e.sent,u(Object(i.__)("Automations will re-run for this cart","wp-marketing-automations")),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),f(e.t0&&e.t0.message?e.t0.message:Object(i.__)("Unknown error occurred","wp-marketing-automations")),console.log(b);case 12:c(!1);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){_(c,a,r,o,i,"next",e)}function i(e){_(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(a.createElement)(v.a,{confirmText:"",confirmButtonText:"",cancelButtonText:"",onConfirm:function(){},isLoading:n,successMessage:l,errorMessage:b,onRequestClose:function(){O(!!l),u(""),f(""),c(!1)},isOpen:p})},A=n(3),C=n(50),x=n(37),T=n(79),I=n(14),P=n(12),R=n(226);function N(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}t.default=function(e){var t=Object(I.h)(),n=L(Object(a.useState)(25),2),c=n[0],j=n[1],v=L(Object(a.useState)(0),2),_=v[0],E=v[1],k=L(Object(a.useState)(0),2),M=k[0],q=k[1],B=L(Object(a.useState)([]),2),D=B[0],F=B[1],U=L(Object(a.useState)([]),2),$=U[0],z=U[1],H=L(Object(a.useState)(!1),2),J=H[0],Q=H[1],G=L(Object(a.useState)(),2),V=G[0],X=G[1],K=L(Object(a.useState)(!1),2),W=K[0],Y=K[1],Z=L(Object(a.useState)(0),2),ee=Z[0],te=Z[1],ne=L(Object(a.useState)(!1),2),ae=ne[0],re=ne[1],ce=L(Object(a.useState)(0),2),oe=ce[0],ie=ce[1];Object(f.a)("recoverable",$);var se=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,a,s,l,u,m,b=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=b.length>0&&void 0!==b[0]?b[0]:{},Q(!0),e.prev=2,n="",t&&t.search&&(n="search=".concat(t.search)),e.next=7,o()({method:"GET",path:Object(r.g)("/carts/recoverable?offset=".concat(_,"&limit=").concat(c,"&").concat(n))});case 7:if((a=e.sent)&&a.result&&Array.isArray(a.result)){e.next=11;break}return X(Object(i.__)("Blank response returned","wp-marketing-automations")),e.abrupt("return");case 11:s=a.total_count,l=a.result,u=a.limit,m=a.offset,s&&q(parseInt(s)),u&&j(parseInt(u)),m&&E(parseInt(m)),l&&F(l),a.hasOwnProperty("count_data")&&z(a.count_data),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),X(e.t0&&e.t0.message?e.t0.message:Object(i.__)("Unknown Error Occurred","wp-marketing-automations"));case 22:Q(!1);case 23:case"end":return e.stop()}}),e,null,[[2,19]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){N(c,a,r,o,i,"next",e)}function i(e){N(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();Object(a.useEffect)((function(){Object(r.d)("Recoverable Carts"),se()}),[_,c]);var le=Object(a.createElement)("span",{className:"bwfan_tooltip_text bwf-w-300","data-position":"top"},Object(a.createElement)("b",null,"Pending"),": Carts where automation is scheduled to trigger. Automation will trigger after a delay of"," ",bwfcrm_contacts_data.abandoned_wait_time," if user does not complete the order.",Object(a.createElement)("br",null),Object(a.createElement)("br",null),Object(a.createElement)("b",null,"In-Progress"),": Carts where automation has triggered and tasks are created.",Object(a.createElement)("br",null),Object(a.createElement)("br",null),Object(a.createElement)("b",null,"Pending (No Tasks Found)"),": Carts where automation triggered but no tasks were created. This is a rare status that occurs due to misconfiguration. Check automation and Retry to create tasks.",Object(a.createElement)("br",null),Object(a.createElement)("br",null),Object(a.createElement)("b",null,"Re-Scheduled"),": Carts where automations are re-scheduled manually from Bulk Actions."),ue=[{key:"action",label:"",isLeftAligned:!0,required:!0,cellClassName:"bwf-col-action bwf-w-30"},{key:"contact",label:Object(i.__)("Contact","wp-marketing-automations"),isLeftAligned:!0},{key:"detail",label:Object(i.__)("Details","wp-marketing-automations"),isLeftAligned:!0},{key:"items",label:Object(i.__)("Items","wp-marketing-automations"),isLeftAligned:!0},{key:"total",label:Object(i.__)("Total","wp-marketing-automations"),isLeftAligned:!0},{key:"order",label:Object(i.__)("Order","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-col-center"},{key:"show",label:"",isLeftAligned:!0},{key:"status",label:Object(a.createElement)("div",{className:"bwf-display-flex",style:{alignItems:"start"}},Object(i.__)("Status","wp-marketing-automations")," ",Object(a.createElement)(C.a,{position:"bottom",toolTipText:le,icon:"info",iconSize:20,size:400})),isLeftAligned:!0,cellClassName:"bwf-col-center"}],me=function(e){e!==c&&(E(0),j(e))},be=function(e){return Object(a.createElement)(s.a,{label:Object(i.__)("Quick Actions","wp-marketing-automations"),menuPosition:"bottom right",renderContent:function(n){var r=n.onToggle;return Object(a.createElement)(a.Fragment,null,1===parseInt(e.status)&&Object(a.createElement)(l.a,{isClickable:!0,onInvoke:function(){Object(I.j)({path:"/carts/recoverable/".concat(e.id,"/tasks")},"/",t),r()}},Object(a.createElement)(u.a,{justify:"flex-start"},Object(a.createElement)(u.c,null,Object(a.createElement)(P.a,{icon:"view"})),Object(a.createElement)(u.c,null,Object(i.__)("View Tasks","wp-marketing-automations")))),Object(a.createElement)(l.a,{isClickable:!0,onInvoke:function(){te(e.id),Y(!0),r()}},Object(a.createElement)(u.a,{justify:"flex-start"},Object(a.createElement)(u.c,null,Object(a.createElement)(P.a,{icon:"trash"})),Object(a.createElement)(u.c,null,Object(i.__)("Delete","wp-marketing-automations")))))}})},fe=function(e,t){switch(parseInt(e)){case 0:return Object(a.createElement)("span",null,Object(i.__)("Pending","wp-marketing-automations"));case 1:return Object(a.createElement)("span",null,Object(i.__)("In-Progress","wp-marketing-automations"));case 3:return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("span",null,Object(i.__)("Pending (No Tasks Found) ","wp-marketing-automations")),Object(a.createElement)("br",null),Object(a.createElement)(m.Button,{isLink:!0,onClick:function(){ie(t),re(!0)}},Object(i.__)("Retry Cart","wp-marketing-automations")));case 4:return Object(a.createElement)("span",null,Object(i.__)("Re-Scheduled","wp-marketing-automations"));default:return"-"}},pe=function(e){return e.total?e.currency?Object(O.a)(e.currency).formatAmount(e.total):e.total:"-"},de=function(e){return e.order_id?Object(a.createElement)("a",{target:"_blank",className:"bwf-a-no-underline",href:"post.php?post=".concat(e.order_id,"&action=edit")},"#",e.order_id," ",e.buyer_name):"-"},Oe=function(e){return Object(a.createElement)("div",{className:"bwf-c-contact-details-cell"},e.email&&Object(a.createElement)(u.a,{justify:"justify",align:"top"},Object(a.createElement)(u.c,null,Object(a.createElement)(P.a,{icon:"mail"})),Object(a.createElement)(u.c,null,e.email)),e.phone&&Object(a.createElement)(u.a,{justify:"justify",align:"top"},Object(a.createElement)(u.c,null,Object(a.createElement)(P.a,{icon:"phone"})),Object(a.createElement)(u.c,null,e.phone)),!e.phone&&!e.email&&Object(a.createElement)("span",null,"-"))},je=function(e){var t=Object(a.createElement)(y.a,{contact:{f_name:e.f_name?e.f_name:"",l_name:e.l_name?e.l_name:"",email:e.email},dateText:Object(i.__)("Last Active:","wp-marketing-automations"),lowerText:e.date?e.diffstring:"-"});return e.contact_id?Object(a.createElement)(x.a,{href:"admin.php?page=autonami&path=/contact/"+e.contact_id,type:"bwf-crm",className:"bwf-a-no-underline"},t):t},ge=Array.isArray(D)?D.map((function(e){return[{display:be(e),value:""},{display:je(e),value:""},{display:Oe(e),value:""},{display:(t=e.items,n="",r=[],Object.entries(t).map((function(e){var t=L(e,2),c=t[0],o=t[1];Object(A.isEmpty)(n)&&(n=Object(a.createElement)("a",{target:"_blank",className:"bwf-a-no-underline",href:"post.php?action=edit&post="+c},o)),r.push(Object(a.createElement)("a",{target:"_blank",className:"bwf-a-no-underline",href:"post.php?action=edit&post="+c},o))})),Object(a.createElement)("div",{className:"bwf-table-v-center"},Object(A.isEmpty)(n)?"-":n,!Object(A.isEmpty)(r)&&r.length>1&&Object(a.createElement)(d.a,{items:r}))),value:e.items},{display:pe(e),value:e.total},{display:de(e),value:e.order_id},{display:Object(a.createElement)(h.a,{cart:e}),value:""},{display:fe(e.status,e.id),value:e.status}];var t,n,r})):[],ye=[{type:"icon",data:{class:"bwf-pb-gap",content:Object(a.createElement)(P.a,{icon:"cart-icon",width:"90",height:"90"})}},{type:"content",data:{class:"bwf-h2 bwf-pb-10",content:Object(i.__)("Cart Tracking is disabled","wp-marketing-automations")}},{type:"content",data:{class:"bwf-h4-1 bwf-pb-gap",content:Object(i.__)("Click on the button below to go to Settings > Carts to enable cart tracking. Once activated, you will be able to capture emails as soon buyer enters it.","wp-marketing-automations")}},{type:"buttons",data:{buttons:[{text:Object(i.__)("Enable Tracking","wp-marketing-automations"),onClick:function(){Object(I.j)({page:"autonami",path:"/settings"},"/",{})}}]}}];return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(T.a,null),Object(r.T)()?Object(a.createElement)(a.Fragment,null,V&&Object(a.createElement)(m.Notice,{status:"error"},V),Object(a.createElement)(b.a,{className:g()("bwfcrm-forms-list-table",{"has-search":!0}),rows:ge,headers:ue,query:{paged:_/c+1},rowsPerPage:c,totalRows:M,isLoading:J,onPageChange:function(e,t){E((e-1)*c)},onQueryChange:function(e){return"per_page"!==e?function(){}:me},rowHeader:!0,showMenu:!1,actions:[Object(a.createElement)(p.a,{onSearch:function(e){se(e)}})],emptyMessage:Object(i.__)("No recoverable carts found","wp-marketing-automations")}),Object(a.createElement)(w.a,{cartId:ee,isOpen:W,onRequestClose:function(e){Y(!1),e&&se()}}),Object(a.createElement)(S,{cartId:oe,isOpen:ae,onRequestClose:function(e){re(!1),e&&se()}})):Object(a.createElement)(R.a,{data:ye}))}}}]);