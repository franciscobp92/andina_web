(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{758:function(e,t,n){"use strict";n.d(t,"b",(function(){return a.a})),n.d(t,"a",(function(){return r.a})),n.d(t,"d",(function(){return c.a})),n.d(t,"e",(function(){return _})),n.d(t,"g",(function(){return v})),n.d(t,"f",(function(){return y})),n.d(t,"h",(function(){return E})),n.d(t,"c",(function(){return k}));var a=n(124),r=n(224),c=n(225),o=n(0),i=n(2),s=n(13),l=n.n(s),u=n(16),m=n.n(u),b=n(45),d=n.n(b),f=n(40),p=n.n(f),g=n(7),O=n(22);function j(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}var _={name:"form-feeds",className:"bwf-search-bwf-tags-result",options:function(e){return(t=regeneratorRuntime.mark((function e(t){var n,a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={search:t,limit:10,offset:0},e.next=3,l()({path:Object(g.g)("/form-feeds?"+Object(O.stringify)(n)),method:"GET"});case 3:return a=e.sent,r=d()(a,"result")?a.result:[],p()(r)||(r=r.map((function(e){return{key:String(e.id),label:e.title}}))),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(a,r){var c=t.apply(e,n);function o(e){j(c,a,r,o,i,"next",e)}function i(e){j(c,a,r,o,i,"throw",e)}o(void 0)}))},function(e){return n.apply(this,arguments)})(e);var t,n},isDebounced:!0,getOptionIdentifier:function(e){return e.key},getOptionKeywords:function(e){return[e.label]},getFreeTextOptions:function(e,t){return[]},getOptionLabel:function(e,t){var n=Object(g.e)(e.label,t)||{};return Object(o.createElement)("span",{key:"name",className:"bwf-search-result-name","aria-label":e.label},Object.keys(n).length>0?Object(o.createElement)(o.Fragment,null,n.suggestionBeforeMatch,Object(o.createElement)("strong",{className:"components-form-token-field__suggestion-match"},n.suggestionMatch),n.suggestionAfterMatch):e.label)},getOptionCompletion:function(e){return e}},w=n(58),h=n(235),v={name:"products",className:"woocommerce-search__product-result",options:function(e){var t=e?{search:e,per_page:10,orderby:"title"}:{};return l()({path:Object(w.addQueryArgs)("/wc-analytics/products",t)})},isDebounced:!0,getOptionIdentifier:function(e){return e.id},getOptionKeywords:function(e){return[e.name,e.sku]},getFreeTextOptions:function(e){return[{key:"title",label:Object(o.createElement)("span",{key:"name",className:"woocommerce-search__result-name"},m()({mixedString:Object(i.__)("All products with titles that include {{query /}}","woocommerce-admin"),components:{query:Object(o.createElement)("strong",{className:"components-form-token-field__suggestion-match"},e)}})),value:{id:e,name:e}}]},getOptionLabel:function(e,t){var n=Object(g.e)(e.name,t)||{};return Object(o.createElement)(o.Fragment,null,Object(o.createElement)(h.a,{key:"thumbnail",className:"woocommerce-search__result-thumbnail",product:e,width:18,height:18,alt:""}),Object(o.createElement)("span",{key:"name",className:"woocommerce-search__result-name","aria-label":e.name},n.suggestionBeforeMatch,Object(o.createElement)("strong",{className:"components-form-token-field__suggestion-match"},n.suggestionMatch),n.suggestionAfterMatch))},getOptionCompletion:function(e){return{key:e.id,label:e.name}}},y={name:"categories",className:"woocommerce-search__product-result",options:function(e){var t=e?{search:e,per_page:10,orderby:"name"}:{};return l()({path:Object(w.addQueryArgs)("/wc-analytics/products/categories",t)})},isDebounced:!0,getOptionIdentifier:function(e){return e.id},getOptionKeywords:function(e){return[e.name]},getFreeTextOptions:function(e){return[{key:"title",label:Object(o.createElement)("span",{key:"name",className:"woocommerce-search__result-name"},m()({mixedString:Object(i.__)("All categories with titles that include {{query /}}","woocommerce-admin"),components:{query:Object(o.createElement)("strong",{className:"components-form-token-field__suggestion-match"},e)}})),value:{id:e,name:e}}]},getOptionLabel:function(e,t){var n=Object(g.e)(e.name,t)||{};return Object(o.createElement)("span",{key:"name",className:"woocommerce-search__result-name","aria-label":e.name},n.suggestionBeforeMatch,Object(o.createElement)("strong",{className:"components-form-token-field__suggestion-match"},n.suggestionMatch),n.suggestionAfterMatch)},getOptionCompletion:function(e){return{key:e.id,label:e.name}}},E={name:"tags",className:"woocommerce-search__product-result",options:function(e){var t=e?{search:e,per_page:10,orderby:"name"}:{};return l()({path:Object(w.addQueryArgs)("/autonami-admin/products/tags",t)})},isDebounced:!0,getOptionIdentifier:function(e){return e.id},getOptionKeywords:function(e){return[e.name]},getFreeTextOptions:function(e){return[{key:"title",label:Object(o.createElement)("span",{key:"name",className:"woocommerce-search__result-name"},m()({mixedString:Object(i.__)("All tags with titles that include {{query /}}","woocommerce-admin"),components:{query:Object(o.createElement)("strong",{className:"components-form-token-field__suggestion-match"},e)}})),value:{id:e,name:e}}]},getOptionLabel:function(e,t){var n=Object(g.e)(e.name,t)||{};return Object(o.createElement)("span",{key:"name",className:"woocommerce-search__result-name","aria-label":e.name},n.suggestionBeforeMatch,Object(o.createElement)("strong",{className:"components-form-token-field__suggestion-match"},n.suggestionMatch),n.suggestionAfterMatch)},getOptionCompletion:function(e){return{key:e.id,label:e.name}}},k={name:"coupons",className:"woocommerce-search__coupon-result",options:function(e){var t=e?{search:e,per_page:10,orderby:"title"}:{};return l()({path:Object(w.addQueryArgs)("/wc-analytics/coupons",t)})},isDebounced:!0,getOptionIdentifier:function(e){return e.code},getOptionKeywords:function(e){return[e.code]},getFreeTextOptions:function(e){return[{key:"code",label:Object(o.createElement)("span",{key:"name",className:"woocommerce-search__result-name"},m()({mixedString:Object(i.__)("All coupons with codes that include {{query /}}","woocommerce-admin"),components:{query:Object(o.createElement)("strong",{className:"components-form-token-field__suggestion-match"},e)}})),value:{id:e,code:e}}]},getOptionLabel:function(e,t){var n=Object(g.e)(e.code,t)||{};return Object(o.createElement)("span",{key:"name",className:"woocommerce-search__result-name","aria-label":e.code},n.suggestionBeforeMatch,Object(o.createElement)("strong",{className:"components-form-token-field__suggestion-match"},n.suggestionMatch),n.suggestionAfterMatch)},getOptionCompletion:function(e){return{key:e.code,label:e.code}}}},763:function(e,t,n){"use strict";var a=n(0),r=n(35),c=n(2),o=n(758);t.a=function(e){var t=e.selected,n=e.onTagsChange;return Object(a.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(a.createElement)("div",{className:"bwf-input-label"},Object(c.__)("Add Tags","wp-marketing-automations")),Object(a.createElement)(r.a,{autocompleter:o.b,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){n(e)},onRemoveTag:function(e,a){var r=t.filter((function(t){return!(t.key==e&&t.label==a)}));n(r)},placeholder:Object(c.__)("Search by tag name","wp-marketing-automations"),showClearButton:!0,disabled:!1}))}},765:function(e,t,n){"use strict";var a=n(0),r=n(35),c=n(2),o=n(758);t.a=function(e){var t=e.selected,n=e.onListsChange;return Object(a.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(a.createElement)("div",{className:"bwf-input-label"},Object(c.__)("Add to Lists","wp-marketing-automations")),Object(a.createElement)(r.a,{autocompleter:o.a,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){n(e)},onRemoveTag:function(e){var a=t.filter((function(t){return t.key!=e}));n(a)},placeholder:Object(c.__)("Search by list name","wp-marketing-automations"),showClearButton:!0,disabled:!1}))}},808:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(0),r=n(4),c=n(2),o=n(3),i=n(763),s=n(765),l=n(17),u=n(79),m=n(12);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var O=function(e){var t=e.headersData,n=e.onRequestImport,b=e.submitButtonText,g=e.secondaryButtonText,O=e.onSecondaryButtonClick,j=e.savedData,_=e.buttonAlignClass,w=e.backButtonText,h=e.backButtonClick,v=e.extra,y=e.isSubmitButtonBusy,E=e.sourceHeaderText,k=void 0===E?Object(c.__)("Columns To Import","wp-marketing-automations"):E,N=e.contactHeaderText,x=void 0===N?Object(c.__)("Map Into Field","wp-marketing-automations"):N,S=e.updateExistingText,C=void 0===S?Object(c.__)("Update existing contacts","wp-marketing-automations"):S,T=t.headers,B=t.fields,A=p(Object(a.useState)(j&&j.mapped_fields?function(e,t){if(!e)return{};var n={},a=function(a){t.find((function(e){return e.index.toString()===a}))&&(n[a]=e[a])};for(var r in e)a(r);return n}(j.mapped_fields,T):{}),2),M=A[0],F=A[1],I=p(Object(a.useState)(1),2),D=I[0],P=I[1],q=j&&j.tags?j.tags.map((function(e){return{key:e.id,label:e.value}})):[],L=j&&j.lists?j.lists.map((function(e){return{key:e.id,label:e.value}})):[],U=p(Object(a.useState)(q),2),R=U[0],H=U[1],K=p(Object(a.useState)(L),2),Q=K[0],J=K[1],z=p(Object(a.useState)(!(!j||!("update_existing"in j))&&j.update_existing),2),G=z[0],$=z[1],V=p(Object(a.useState)(!j||!("marketing_status"in j)||j.marketing_status),2),W=V[0],X=(V[1],p(Object(a.useState)(!(!j||!("trigger_events"in j))&&j.trigger_events),2)),Y=X[0],Z=X[1],ee=p(Object(a.useState)(null),2),te=ee[0],ne=ee[1],ae=(v||{}).disableMarketingStatusCheck,re=void 0!==ae&&ae,ce=function(){return ne(null),0===Object(o.size)(M)?(setTimeout((function(){return ne(Object(c.__)("Select the contact fields.","wp-marketing-automations"))}),500),!1):!!Object.values(M).includes("email")||(setTimeout((function(){return ne(Object(c.__)("Map contact email with a form field.","wp-marketing-automations"))}),500),!1)},oe=function(){if(ce()){var e={};T.map((function(t){t.index in M&&(e[t.index]=M[t.index])}));var t={map:e,tags:R.map((function(e){return{id:e.key,value:e.label}})),lists:Q.map((function(e){return{id:e.key,value:e.label}})),update_existing:G,trigger_events:Y,imported_contact_status:D};!re&&(t.marketing_status=W),n(t)}},ie=function(){if(ce()){var e={};T.map((function(t){t.index in M&&(e[t.index]=M[t.index])}));var t={map:e,tags:R.map((function(e){return{id:e.key,value:e.label}})),lists:Q.map((function(e){return{id:e.key,value:e.label}})),update_existing:G,trigger_events:Y};!re&&(t.marketing_status=W),O(t)}};if(!Object(o.isArray)(B)||!B.length>0)return Object(a.createElement)(r.Notice,{status:"error"},Object(c.__)("No contact fields found"));if(!Object(o.isArray)(T)||!T.length>0)return Object(a.createElement)(r.Notice,{status:"error"},Object(c.__)("No mapping fields found"));var se={0:Object(c.__)("Unverified","wp-marketing-automation-crm"),1:Object(c.__)("Subscribed","wp-marketing-automation-crm"),2:Object(c.__)("Bounced","wp-marketing-automation-crm"),3:Object(c.__)("Unsubscribed","wp-marketing-automation-crm")};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-c-import-mapper-fields bwf-card-wrap bwf-form-fields bwf-crm-importer-csv-wrap"},Object(a.createElement)("div",{className:"bwf-card-header"},Object(a.createElement)("span",{className:"bwf-form-title"},Object(c.__)("Mapping","wp-marketing-automations"))),te&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(u.a,null),Object(a.createElement)(r.Notice,{status:"error",onRemove:function(){return ne(null)}},te)),Object(a.createElement)("div",{className:"bwf-crm-import-section"},Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-c-import-field"},Object(a.createElement)("strong",null,k),Object(a.createElement)("span",null),Object(a.createElement)("strong",null,x)),T.map((function(e){return Object(a.createElement)("div",{key:e.index,className:"bwf-c-import-field"},Object(a.createElement)(r.TextControl,{disabled:!0,value:e.header}),Object(a.createElement)("span",{className:"bwf-display-flex"},Object(a.createElement)(m.a,{icon:"mapper"})),Object(a.createElement)("select",{value:e.index in M?M[e.index]:"",onChange:function(t){return function(e,t){var n=t.target.value,a="index"in e?e.index:"";""===n&&a in M?F(Object(o.omit)(M,a)):""!==n&&""!==a&&F(d(d({},M),{},f({},a,n)))}(e,t)}},Object(a.createElement)("option",{value:""},Object(c.__)("Do not import this field","wp-marketing-automations")),B.map((function(e){return"fields"in e&&e.fields.length>0&&Object(a.createElement)("optgroup",{key:e.id,label:e.name},e.fields.map((function(e){return Object(a.createElement)("option",{key:e.id,value:e.id},e.name)})))}))))}))),Object(a.createElement)("div",{className:"bwf-crm-import-section"},Object(a.createElement)("div",{className:"bwf-h4"},Object(c.__)("Contact Profile","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf-c-import-field"},Object(a.createElement)(i.a,{onTagsChange:H,selected:R}),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)(s.a,{onListsChange:J,selected:Q})),Object(a.createElement)("div",{className:"bwf_clear_10"}),!re&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-p"},Object(c.__)("Status","wp-marketing-automations")),Object(a.createElement)("select",{className:"bwf-import-csv-status-select",onChange:function(e){P(e.target.value)}},Object.keys(se).map((function(e){return Object(a.createElement)("option",{key:e,value:e,selected:D==e},se[e])})))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",null,Object(a.createElement)(r.ToggleControl,{label:C,checked:G,className:"bwf-tooglecontrol-advance",onChange:$})),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",null,Object(a.createElement)(r.ToggleControl,{label:Object(c.__)("Trigger automations (for tag & list related events)","wp-marketing-automations"),checked:Y,className:"bwf-tooglecontrol-advance",onChange:Z}))),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},_?Object(a.createElement)(a.Fragment,null,Object(a.createElement)(l.a,null,!!w&&Object(a.createElement)(l.b,null,Object(a.createElement)(r.Button,{isSecondary:!0,onClick:h},Object(a.createElement)("span",null,w))),Object(a.createElement)(l.b,{className:_},Object(a.createElement)(r.Button,{onClick:oe,isPrimary:!0},Object(a.createElement)("span",null,b||Object(c.__)("Import","wp-marketing-automations"))),g&&Object(a.createElement)(r.Button,{onClick:ie,className:"bwf-ml-10",isSecondary:!0},g)))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)(r.Button,{onClick:oe,isPrimary:!0,isBusy:!!y,disabled:!!y,className:"bwf-display-flex"},Object(a.createElement)("span",null,b||Object(c.__)("Import","wp-marketing-automations"))),g&&Object(a.createElement)(r.Button,{onClick:ie,className:"bwf-ml-10",isSecondary:!0},g)))))}},903:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(4),c=n(2),o=n(774),i=n(808),s=n(775),l=n(79),u=n(34),m=n(7);t.default=function(e){var t=e.feedId,n=Object(o.a)(),b=n.setStep,d=n.fetchMappingData,f=n.updateStepTwo,p=n.resetUpdateStepTwoStatus,g=Object(s.a)(),O=g.getFormFields,j=g.getFormHeaders,_=g.getFeed,w=g.getLoading,h=g.getError,v=g.getEditMapMode,y=g.getUpdateStepTwoStatus,E={fields:O(),headers:j()},k=w(),N=h(),x=_(),S=x&&x.status?parseInt(x.status):1,C=x&&x.data?x.data:{},T=v(),B=y();Object(a.useEffect)((function(){d(parseInt(t))}),[]);var A=Object(a.useContext)(m.b);Object(a.useEffect)((function(){3===B&&A("Unable to save mapping data"),2===B&&(A("Mapping data saved successfully"),b("double_optin")),B&&1!==B&&(p(),setTimeout((function(){return A("")}),3e3))}),[B]);var M=Object(c.__)("Next","wp-marketing-automations");return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(l.a,null),Object(a.createElement)("div",{className:"bwf-crm-stepper-wrap"},Object(a.createElement)("div",{className:"bwf-crm-importer-wrap"},N&&Object(a.createElement)(r.Notice,{status:"error"},N.message?N.message:Object(c.__)("Unknown error occurred","wp-marketing-automations")),k?Object(a.createElement)(u.a,null):Object(a.createElement)(i.a,{headersData:E,onRequestImport:function(e){f(t,e,S)},submitButtonText:M,submitButtonIcon:"arrow-right-alt",savedData:C,buttonAlignClass:"bwf_text_right",backButtonText:!T&&Object(c.__)("Back","wp-marketing-automation-crm"),backButtonClick:!T&&function(){return b("selection")},sourceHeaderText:Object(c.__)("Forms Fields","wp-marketing-automation-crm"),contactHeaderText:Object(c.__)("Contact Fields","wp-marketing-automation-crm"),extra:{disableMarketingStatusCheck:!0},isSubmitButtonBusy:1===B}))))}}}]);