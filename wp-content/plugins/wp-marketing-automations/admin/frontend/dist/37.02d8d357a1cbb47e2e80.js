(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{759:function(e,t,n){"use strict";var a=n(221),r=n(242),c=Object(a.a)(r.a.campaign).getStateProp,o=Object(a.a)(r.a.recipient).getStateProp,i=Object(a.a)(r.a.conversion).getStateProp;t.a={getCampaignData:function(){return c("data")},getStep:function(){return parseInt(c("step"))},getLoading:function(){return c("isLoading")},getCampaignId:function(){return parseInt(c("campaignId"))},getRecipientData:function(){return o("data")},getRecipientLoading:function(){return o("isLoading")},getRecipientCampaignId:function(){return o("campaignId")},getRecipientTotal:function(){return o("total")},getRecipientPage:function(){return parseInt(o("offset"))/parseInt(o("limit"))+1},getRecipientOffset:function(){return o("offset")},getRecipientLimit:function(){return o("limit")},getConversionData:function(){return i("data")},getConversionLoading:function(){return i("isLoading")},getConversionOffset:function(){return i("offset")},getConversionCampaignId:function(){return i("campaignId")},getConversionTotal:function(){return i("total")},getConversionPage:function(){return parseInt(i("offset"))/parseInt(i("limit"))+1},getConversionLimit:function(){return i("limit")},getExcludes:function(){var e=c("data");return e&&e.data&&Array.isArray(e.data.exclude)?e.data.exclude:[]},getEditableMode:function(){return c("editableMode")}}},767:function(e,t,n){"use strict";var a=n(219),r=n(0),c=n(2),o=n(14),i=n(22),s=n(759),u=n(7),l=function(e,t,n){return decodeURIComponent(Object(o.f)(e,t,n))};t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",b=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,f=location&&location.search?Object(i.parse)(location.search.substring(1)):{},p=bwfcrm_contacts_data&&bwfcrm_contacts_data.header_data?bwfcrm_contacts_data.header_data:{},d=p.broadcasts_nav,O=s.a.getCampaignData(),g=s.a.getCampaignId(),j={overview:{name:Object(c.__)("Overview","wp-marketing-automations"),link:l({},"/broadcast/".concat(g,"/overview"),f)},analytics:{name:Object(c.__)("Analytics","wp-marketing-automations"),link:l({},"/broadcast/".concat(g,"/analytics"),f)},recipient:{name:Object(c.__)("Engagements","wp-marketing-automations"),link:l({},"/broadcast/".concat(g,"/engagements"),f)}};Object(u.fb)()&&(j.orders={name:Object(c.__)("Orders","wp-marketing-automations"),link:l({},"/broadcast/".concat(g,"/orders"),f)});var h=Object(a.a)(),v=h.setActiveMultiple,y=h.resetHeaderMenu,w=h.setL2NavType,_=h.setL2Nav,E=h.setBackLink,k=h.setL2Title,P=h.setL2Content,S=h.setBackLinkLabel,C=h.setL2NavAlign,N=h.setPageHeader;return Object(r.useEffect)((function(){y(),o?(w("menu"),_(j)):(!n&&w("menu"),!n&&_(d)),v({leftNav:"broadcasts",rightNav:e}),n&&1===b&&(S("Email Broadcasts"),E(l({},"/broadcasts/email",f))),n&&2===b&&(S("SMS Broadcasts"),E(l({},"/broadcasts/sms",f))),n&&3===b&&(S("WhatsApp Broadcasts"),E(l({},"/broadcasts/whatsapp",f))),t?k(t):o&&k(O.title),o&&C("left"),!n&&m&&P(m),N("Broadcasts")}),[e,b]),!0}},801:function(e,t,n){"use strict";var a=n(13),r=n.n(a),c=n(7),o=n(757);function i(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}var s=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r()({path:Object(c.g)("/messages/daily-limit")});case 2:if((t=e.sent)&&t.result&&200==t.code){e.next=5;break}throw Error(__("Unable to get daily limit","wp-marketing-automations"));case 5:return e.abrupt("return",t.result);case 6:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){i(c,a,r,o,s,"next",e)}function s(e){i(c,a,r,o,s,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();t.a=function(){return Object(o.a)(["bwfcrm-get-daily-limit"],s,{retry:!1})}},824:function(e,t,n){},910:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(22),c=n(2),o=n(222),i=n(7);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=function(){var e=Object(o.a)("campaignList"),t=e.fetch,n=e.setStateProp;return u(u({},m(e,["fetch","setStateProp"])),{},{fetch:function(e,n,a,r){var c=n.s,o=(n.page,n.filter,n.path,{offset:a,limit:r,type:e,search:c,filters:m(n,["s","page","filter","path"])});t("GET",Object(i.g)("/broadcasts"),o)},setCamapignListValues:function(e,t){n(e,t)}})},f=n(221);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var j=function(){var e=Object(f.a)("campaignList"),t=e.getStateProp;return d(d({},g(e,["getStateProp"])),{},{getCampaigns:function(){return t("campaigns")},getPageNumber:function(){return parseInt(t("offset"))/parseInt(t("limit"))+1},getPerPageCount:function(){return parseInt(t("limit"))},getOffset:function(){return parseInt(t("offset"))},getTotalCount:function(){return parseInt(t("total"))},getLoadingStatus:function(){return t("isLoading")},getPageCountData:function(){return t("countData")}})},h=n(13),v=n.n(h),y=n(220),w=n(37),_=n(46),E=n(4),k=n(122),P=n(35),S=n(40),C=n.n(S),N=n(104),x=n.n(N),A=n(45),I=n.n(A),T=n(3),L=n(14),R=n(16),D=n.n(R);function F(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}var B=function(e){return e.title},M={"/broadcasts":1,"/broadcasts/":1,"/broadcasts/email":1,"/broadcasts/email/":1,"/broadcasts/sms":2,"/broadcasts/sms/":2,"/broadcasts/whatsapp":3,"/broadcasts/whatsapp/":3},q={name:"campaigns",className:"bwf-search-bwf-campaign-result",options:function(e){return(t=regeneratorRuntime.mark((function e(t){var n,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(L.h)(),a={limit:5,offset:0,type:M.hasOwnProperty(n.path)?M[n.path]:""},C()(t)&&(a.search=t),e.next=5,v()({path:Object(i.g)("/broadcasts?"+Object(r.stringify)(a)),method:"GET"});case 5:return c=e.sent,e.abrupt("return",I()(c,"result")?c.result.campaigns:[]);case 7:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(a,r){var c=t.apply(e,n);function o(e){F(c,a,r,o,i,"next",e)}function i(e){F(c,a,r,o,i,"throw",e)}o(void 0)}))},function(e){return n.apply(this,arguments)})(e);var t,n},isDebounced:!0,getOptionIdentifier:function(e){return e.id},getOptionKeywords:function(e){return[e.title]},getFreeTextOptions:function(e,t){return[{key:"name",label:Object(a.createElement)("span",{key:"name",className:"bwf-search-result-name"},D()({mixedString:Object(c.__)("All Broadcast with title that include {{query /}}","wp-marketing-automations"),components:{query:Object(a.createElement)("strong",{className:"components-form-token-field__suggestion-match"},e)}})),value:{id:e,name:e,campaigns:t.map((function(e){return I()(e,"value")?e.value:e})),searchTerm:e}}]},getOptionLabel:function(e,t){var n=Object(i.e)(B(e),t)||{};return Object(a.createElement)("span",{key:"name",className:"bwf-search-result-name","aria-label":B(e)},Object.keys(n).length>0?Object(a.createElement)(a.Fragment,null,n.suggestionBeforeMatch,Object(a.createElement)("strong",{className:"components-form-token-field__suggestion-match"},n.suggestionMatch),n.suggestionAfterMatch):B(e))},getOptionCompletion:function(e){return e}};function U(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}var z=function(e){var t=e.query,n=t.hasOwnProperty("s")?t.s:"",r=C()(n)?[]:[{key:n,label:Object(c.__)("Search Broadcast: ","wp-marketing-automations")+n,bwfLabelSource:"bwfcrm_campaign",isSearchTerm:!0}],o=function(){var e,n=(e=regeneratorRuntime.mark((function e(n){var a,r,c,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x()(n)){e.next=2;break}return e.abrupt("return");case 2:if(C()(n)||(a=n[n.length-1],(n=[])[0]=a),r=n.find((function(e){return I()(e,"searchTerm")})),!(Object(T.isUndefined)(r)&&n.length>0&&n[0].hasOwnProperty("id"))){e.next=7;break}return Object(L.j)({path:"/broadcast/"+n[0].id},"/",t),e.abrupt("return");case 7:if(c=Object(T.isUndefined)(r)?void 0:r.searchTerm,o=I()(t,"s")&&!C()(t.s)?t.s:"",c!==o){e.next=11;break}return e.abrupt("return");case 11:Object(L.j)({s:c},"/broadcasts",t);case 12:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){U(c,a,r,o,i,"next",e)}function i(e){U(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}();return Object(a.createElement)(P.a,{autocompleter:q,multiple:!1,allowFreeTextSearch:!0,inlineTags:!0,selected:r,onChange:o,placeholder:Object(c.__)("Search by name","wp-marketing-automations"),showClearButton:!0,disabled:!1,bwfEnableEmptySearch:!0})},X=n(56),H=n(17),V=(n(824),n(80)),W=n(81),$=n(34),G=n(5),J=n.n(G),K=n(12),Q=n(50);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=ce(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function ne(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}function ae(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){ne(c,a,r,o,i,"next",e)}function i(e){ne(c,a,r,o,i,"throw",e)}o(void 0)}))}}function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||ce(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){if(e){if("string"==typeof e)return oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oe(e,t):void 0}}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ie=function(e){var t=e.query,n=e.type,r=e.onRequestSendUnopen,o=re(Object(a.useState)({status:!1}),2),s=o[0],u=o[1],l=Object(i.N)("campaign"),m=b(),f=j(),p=Object(i.j)(),d=m.fetch,O=m.setCamapignListValues,g=f.getCampaigns,h=f.getPageNumber,P=f.getPerPageCount,S=f.getTotalCount,C=f.getOffset,N=f.getLoadingStatus,x=g(),A=C(),I=P(),L=N(),R=S(),D=h(),F=Object(X.a)(Object(i.L)()).formatAmount,B=0;Object(T.isEmpty)(n)||("email"===n?B=1:"sms"===n?B=2:"whatsapp"===n&&(B=3)),Object(a.useEffect)((function(){d(B,t,A,I)}),[A,I,n,t.s]);var M=[{key:"action",label:"",isLeftAligned:!0,required:!0,cellClassName:"bwf-col-action bwf-w-30"},{key:"campaign",label:Object(c.__)("Name","wp-marketing-automations"),isLeftAligned:!0,required:!0},{key:"schedule",label:Object(c.__)("Date","wp-marketing-automations"),isLeftAligned:!0},{key:"contacts",label:Object(c.__)("Contacts","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-col-center"},{key:"sent",label:Object(c.__)("Sent","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-col-center"}];"sms"!==n&&M.push({key:"open_rate",label:Object(c.__)("Open Rate","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-col-center"}),M.push({key:"click_rate",label:Object(c.__)("Click Rate","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-col-center"}),Object(i.fb)()&&M.push({key:"revenue",label:Object(c.__)("Revenue","wp-marketing-automations"),isLeftAligned:!0,cellClassName:"bwf-col-center"}),M.push({key:"status",label:Object(c.__)("Status","wp-marketing-automations"),isLeftAligned:!0});var q=function(e){e!==I&&O("limit",e)},U=function(){var e=ae(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v()({path:Object(i.g)("/broadcast/".concat(n,"/")),method:"POST",headers:{"X-HTTP-Method-Override":"DELETE"}}).then((function(e){200==e.code?(u({status:!0,success:!0,message:e.message}),setTimeout((function(){u({}),d(B,t,0,I)}),2e3)):u({status:!0,error:!0,message:e.message})}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),u({status:!0,error:!0,message:e.t0.message});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=ae(regeneratorRuntime.mark((function e(n,a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u({status:!0,confirm:!0}),e.prev=1,e.next=4,v()({path:Object(i.g)("/broadcast/".concat(n,"/pause-unpause")),method:"POST",data:{status:parseInt(a)},headers:{"X-HTTP-Method-Override":"POST"}}).then((function(e){200==e.code?(u({status:!0,success:!0,message:e.message}),setTimeout((function(){u({}),d(B,t,0,I)}),2e3)):u({status:!0,confirm:!0,error:!0,message:e.message})}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),u({status:!0,confirm:!0,error:!0,message:e.t0.message});case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}(),Y=function(){var e=ae(regeneratorRuntime.mark((function e(n){var a,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]&&r[1],u({status:!0,confirm:!0}),e.prev=2,e.next=5,v()({path:Object(i.g)("/broadcast/".concat(n,"/clone")),method:"POST",data:{created_by:Object(i.o)(),send_to_unopen:a},headers:{"X-HTTP-Method-Override":"POST"}}).then((function(e){200==e.code?(u({status:!0,success:!0,message:e.message}),setTimeout((function(){u({}),d(B,t,0,I)}),2e3)):u({status:!0,confirm:!0,error:!0,message:e.message})}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),u({status:!0,confirm:!0,error:!0,message:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}(),ee=function(e){return Object(a.createElement)(_.a,{label:Object(c.__)("Quick Actions","wp-marketing-automations"),menuPosition:"bottom right",renderContent:function(t){var o=t.onToggle;return Object(a.createElement)(a.Fragment,null,parseInt(e.status)>1&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){}},Object(a.createElement)(w.a,{href:"admin.php?page=autonami&path=/broadcast/"+e.id,type:"bwf-crm",className:"bwf-a-no-underline"},Object(a.createElement)(H.a,{justify:"flex-start"},Object(a.createElement)(H.c,null,Object(a.createElement)(K.a,{icon:"view",size:20})),Object(a.createElement)(H.c,null,Object(c.__)("View","wp-marketing-automations"))))),parseInt(e.status)<3&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){}},Object(a.createElement)(w.a,{href:"admin.php?page=autonami&path=/broadcast/".concat(e.id,"&edit=true"),type:"bwf-crm",className:"bwf-a-no-underline"},Object(a.createElement)(H.a,{justify:"flex-start"},Object(a.createElement)(H.c,null,Object(a.createElement)(K.a,{icon:"edit",size:20})),Object(a.createElement)(H.c,null,Object(c.__)("Edit","wp-marketing-automations"))))),Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){Y(e.id),o()}},Object(a.createElement)(H.a,{justify:"flex-start"},Object(a.createElement)(H.c,null,Object(a.createElement)(K.a,{icon:"duplicate"})),Object(a.createElement)(H.c,null,Object(c.__)("Clone","wp-marketing-automations")))),4===parseInt(e.status)&&"grandchild"!==e.level&&"email"===n&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){r&&r(parseInt(e.id)),o()}},Object(a.createElement)(H.a,{justify:"flex-start"},Object(a.createElement)(H.c,null,Object(a.createElement)(K.a,{icon:"duplicate"})),Object(a.createElement)(H.c,null,Object(c.__)("Send to Unopen","wp-marketing-automations")))),3===parseInt(e.status)&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){G(e.id,6),o()}},Object(a.createElement)(H.a,{justify:"flex-start"},Object(a.createElement)(H.c,null,Object(a.createElement)(K.a,{icon:"pause"})),Object(a.createElement)(H.c,null,Object(c.__)("Pause","wp-marketing-automations")))),6===parseInt(e.status)&&Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){G(e.id,3),o()}},Object(a.createElement)(H.a,{justify:"flex-start"},Object(a.createElement)(H.c,null,Object(a.createElement)(K.a,{icon:"play"})),Object(a.createElement)(H.c,null,Object(c.__)("Resume","wp-marketing-automations")))),Object(a.createElement)(k.a,{isClickable:!0,onInvoke:function(){u({status:!0,id:e.id}),o()}},Object(a.createElement)(H.a,{justify:"flex-start"},Object(a.createElement)(H.c,null,Object(a.createElement)(K.a,{icon:"trash"})),Object(a.createElement)(H.c,null,Object(c.__)("Delete","wp-marketing-automations")))))}})},ne=function(e){return Object(a.createElement)(w.a,{href:"admin.php?page=autonami&path=/broadcast/"+e.id,type:"bwf-crm",className:"bwf-a-no-underline"},Object(a.createElement)("b",null,e.title.charAt(0).toUpperCase()+e.title.slice(1)+" "))},ce=function(e){return parseFloat(e.revenue)>0?Object(a.createElement)(a.Fragment,null,parseInt(e.conversions)>0?parseInt(e.conversions)+" ( "+F(parseFloat(e.revenue))+" )":F(parseFloat(e.revenue))):" - "},oe=Object(a.useMemo)((function(){var e,t=[],n=te(x);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(a){var r=Z({},a);if(delete r.children,t.push(r),Array.isArray(a.children)&&!(a.children.length<=0)){var c,o=te(a.children);try{for(o.s();!(c=o.n()).done;){var i=c.value,s=Z(Z({},i),{},{level:"child"});if(delete s.children,t.push(s),Array.isArray(i.children)&&!(i.children.length<=0)){var u,l=te(i.children);try{for(l.s();!(u=l.n()).done;){var m=Z(Z({},u.value),{},{level:"grandchild"});t.push(m)}}catch(e){l.e(e)}finally{l.f()}}}}catch(e){o.e(e)}finally{o.f()}}}}}catch(e){n.e(e)}finally{n.f()}return t}),[x]),ie=[],se=oe?oe.map((function(e){e.level&&"child"===e.level?ie.push("bwf-c-broadcast-child"):e.level&&"grandchild"===e.level?ie.push("bwf-c-broadcast-grandchild"):ie.push("bwf-c-broadcast-parent");var t=[{display:ee(e),value:null},{display:ne(e),value:e.title},{display:e.execution_time?Object(i.D)(e.execution_time):" - ",value:e.execution_time},{display:parseInt(e.count)>0?e.count:"-",value:e.count>0?e.count:0},{display:parseInt(e.sent)>0?e.sent:"-",value:e.sent}];return"sms"!==n&&t.push({display:e.open_rate?parseFloat(e.open_rate).toFixed(2)+"%":"-",value:e.open_rate}),t.push({display:e.click_rate?parseFloat(e.click_rate).toFixed(2)+"%":"-",value:e.click_rate}),Object(i.fb)()&&t.push({display:ce(e),value:parseFloat(e.revenue)}),t.push({display:p.hasOwnProperty(e.status)?p[e.status].label:e.status,value:e.status}),t})):[],ue=J()("bwfcrm-campaign-list-table",{"has-search":!0});return Object(a.createElement)(a.Fragment,null,s&&s.status&&Object(a.createElement)(E.Modal,{title:"",onRequestClose:function(){return u({})},className:"bwf-admin-modal bwf-admin-modal-small bwf-admin-modal-no-header"},s.success?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-t-center"},Object(a.createElement)(V.a,null),Object(a.createElement)("div",{className:"bwf-h1"},s.message))):s.error?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-t-center"},Object(a.createElement)(W.a,null),Object(a.createElement)("div",{className:"bwf-h1"},s.message))):s.confirm?Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-t-center"},Object(a.createElement)($.a,null))):Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-h4"},Object(c.__)("Delete","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf-t-center bwf-form-buttons"},Object(a.createElement)("div",{className:"bwf-h2"},Object(c.__)("Are you sure?","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf_clear_15"}),Object(a.createElement)("div",{className:"bwf-h4 bwf-h4-grey"},Object(c.__)("Once you delete this item. It will no longer available.","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)("div",{className:"bwf_text_right"},Object(a.createElement)(E.Button,{isTertiary:!0,onClick:function(){u({status:!1})}},Object(c.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(E.Button,{isPrimary:!0,className:"bwf-delete-btn",onClick:function(){u({status:!0,id:s.id,confirm:!0}),U(s.id)}},Object(c.__)("Delete","wp-marketing-automations")))))),Object(a.createElement)(y.a,{className:ue,rows:se,headers:function(e){if(Object(T.isEmpty)(l))return e;var t=[];return e.map((function(e){l.includes(e.key)||(e.visible=!1),t.push(e)})),t}(M),query:{paged:D},rowsPerPage:I,totalRows:R,isLoading:L,onPageChange:function(e,t){O("offset",(e-1)*I)},onQueryChange:function(e){return"per_page"!==e?function(){}:q},onColumnsChange:function(e,t){v()({path:Object(i.g)("/user-preference/".concat(Object(i.o)(),"/")),method:"POST",data:{data:{campaign_column:e}}}).then((function(t){200===t.code&&(bwfcrm_contacts_data.table_column_data.campaign=e)}))},actions:[Object(a.createElement)(z,{key:"search",query:t})],rowHeader:!0,emptyMessage:Object(c.__)("No broadcasts found","wp-marketing-automations"),rowClasses:ie,filterColumnIcon:Object(a.createElement)("span",{className:"bwf-cursor-pointer"},Object(a.createElement)(Q.a,{icon:"filters",iconSize:25,size:30,toolTipText:Object(a.createElement)("span",{className:"bwfan_tooltip_text bwf-w-60","data-position":"top"},Object(c.__)("Filter","wp-marketing-automations"))}))}))},se=n(200);function ue(e,t,n,a,r,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return me(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var be=function(e){var t=e.query,n=e.onCloseModal,r=e.type,o=e.createUnopen,s=le(Object(a.useState)(!1),2),u=s[0],l=s[1],m=le(Object(a.useState)(""),2),b=m[0],f=m[1],p=le(Object(a.useState)({}),2),d=p[0],O=p[1],g=le(Object(a.useState)(null),2),j=g[0],h=g[1],y=le(Object(a.useState)(""),2),w=y[0],_=y[1];Object(a.useEffect)((function(){l(!1),O({}),h(""),_(""),f("")}),[]);var k=function(){var e,n=(e=regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),f(""),e.prev=2,n={title:j,description:w,type:r,created_by:Object(i.o)()},o&&(a=Object(c.__)("Send to Unopen","wp-marketing-automations"),j||(h(a),n.title=a),n.createUnopen=o),e.next=7,v()({path:Object(i.g)("/broadcast/"),method:"POST",data:n}).then((function(e){200==e.code?(Object(i.v)()||(bwfcrm_contacts_data.first_broadcast_id=1),Object(L.j)({path:"/broadcast/"+e.result.id},"/",t)):(l(!1),f(e.message))}));case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),l(!1),f(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){ue(c,a,r,o,i,"next",e)}function i(e){ue(c,a,r,o,i,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();Object(a.useEffect)((function(){o&&k()}),[o]);var P=function(){Object(se.a)(j)?f(Object(c.__)("Name is required.","wp-marketing-automations")):(f(""),k())},S={1:Object(c.__)("Add Email Broadcast","wp-marketing-automations"),2:Object(c.__)("Add SMS Broadcast","wp-marketing-automations"),3:Object(c.__)("Add WhatsApp Broadcast","wp-marketing-automations")};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(E.Modal,{title:S[r],className:"bwf-admin-modal bwf-admin-modal-medium",onRequestClose:function(){return n()}},u?d&&d.success&&d.message?Object(a.createElement)("div",{className:"bwf-t-center"},Object(a.createElement)(V.a,null),Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)("div",{className:"bwf-h1"},Object(c.__)("Broadcast ")," ",d.data.title," ",Object(c.__)(" Successfully Created")),Object(a.createElement)("p",{style:{fontSize:"18px",color:"#949393"}},Object(c.__)("Hold on while we are rerouting you to the editor's page.","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf_clear_20"})):d&&d.error&&d.message?Object(a.createElement)("div",{className:"bwf-t-center"},Object(a.createElement)(W.a,null),Object(a.createElement)("div",{className:"bwf-h1"},d.message)):Object(a.createElement)($.a,null):3!=r||Object(i.db)()?Object(a.createElement)("div",{className:"bwf-form-fields",onKeyPress:function(e){"Enter"==e.key&&P()}},b&&Object(a.createElement)(E.Notice,{status:"error",onRemove:function(){return f("")}},b),Object(a.createElement)(E.TextControl,{placeholder:Object(c.__)("Enter Name","wp-marketing-automations"),autoFocus:!0,label:Object(c.__)("Name","wp-marketing-automations"),value:j,onChange:function(e){return h(e)},disabled:u}),Object(a.createElement)("div",{className:"bwf_text_right bwf-form-buttons"},Object(a.createElement)(E.Button,{onClick:function(){return n()},isTertiary:!0},Object(c.__)("Cancel","wp-marketing-automations")),Object(a.createElement)(E.Button,{isPrimary:!0,disabled:u,onClick:function(){P()}},Object(c.__)("Add","wp-marketing-automations")))):Object(a.createElement)(E.Notice,{status:"error",isDismissible:!1},"Whats service is not configured")))},fe=n(767),pe=n(79),de=n(801),Oe=n(123),ge=n(126),je=n(219),he=n(226);function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){we(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function we(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ee(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}t.default=function(e){var t=e.match.params.type,n=void 0===t?"email":t,o=location&&location.search?Object(r.parse)(location.search.substring(1)):{};Object(i.d)("Broadcasts");var s=_e(Object(a.useState)(!1),2),u=s[0],l=s[1],m=_e(Object(a.useState)(!0),2),b=m[0],f=m[1],p=_e(Object(a.useState)(!1),2),d=p[0],O=p[1],g=_e(Object(a.useState)(!1),2),h=g[0],v=g[1],y=(0,j().getPageCountData)(),_=Object(ge.a)().getPageCountData,k=Object(je.a)().setPageCountData,P=_();Object(a.useEffect)((function(){k(ye(ye({},P),y))}),[y]),Object(fe.a)(n,Object(c.__)("ALL BROADCASTS","wp-marketing-automations"),!1,!1,Object(a.createElement)(E.Button,{isPrimary:!0,onClick:function(){Object(i.X)()?(v(!1),l(!0)):O(!0)},className:"bwf-display-flex"},!Object(i.X)()&&Object(a.createElement)(K.a,{icon:"lock",size:15}),Object(c.__)("Add New","wp-marketing-automations")),1,y);var S=(Object(i.X)()?Object(de.a)():{}).data,C=S||{},N=C.reached,x=void 0!==N&&N,A=C.daily_limit,I=void 0===A?0:A,T={email:1,sms:2,whatsapp:3},L=[{type:"icon",data:{class:"bwf-pb-gap",content:Object(a.createElement)(K.a,{icon:"zero-broadcast",width:"90",height:"90"})}},{type:"content",data:{class:"bwf-h2 bwf-pb-10",content:Object(c.__)("Reach out with personalized messages","wp-marketing-automations")}},{type:"content",data:{class:"bwf-h4-1 bwf-pb-gap",content:Object(c.__)("Send announcements to all or tailored messages to specific customer segments. Filter contacts by last order date, item purchase, AOV & more.","wp-marketing-automations")}},{type:"buttons",data:{buttons:[{text:Object(c.__)("Add New Broadcast","wp-marketing-automations"),onClick:function(){Object(i.X)()?(v(!1),l(!0)):O(!0)}}]}}];return Object(a.createElement)(a.Fragment,null,Object(i.v)()?Object(a.createElement)(a.Fragment,null,Object(a.createElement)(pe.a,null),"email"===n&&!!x&&!!b&&Object(a.createElement)(E.Notice,{className:"bwf-error-notice",status:"warning",onRemove:function(){return f(!1)}},"".concat(Object(c.__)("Daily sending limit of","wp-marketing-automations")," ").concat(I," ").concat(Object(c.__)(" emails has been reached today. To send out more emails, go to ","wp-marketing-automations")," "),Object(a.createElement)(w.a,{href:"admin.php?page=autonami&path=/settings",className:"bwf-a-no-underline"},Object(c.__)("Settings > Emails","wp-marketing-automations")),Object(c.__)(" to increase the limit.","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwfcrm-campaign-list"},Object(a.createElement)(ie,{query:o,type:n,onRequestSendUnopen:function(e){Object(i.X)()?(v(e),l(!0)):O(!0)}}))):Object(a.createElement)(he.a,{data:L}),u&&Object(a.createElement)(be,{query:o,createUnopen:h,onCloseModal:function(){return l(!1)},type:T.hasOwnProperty(n)?T[n]:1}),Object(a.createElement)(Oe.a,{isOpen:d,onRequestClose:function(){return O(!1)}}))}}}]);